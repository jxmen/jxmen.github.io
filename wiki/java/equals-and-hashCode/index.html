<!DOCTYPE html>
<html>
    <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- 참고: https://jekyllrb.com/docs/liquid/filters/ -->
    <title>equals와 hashCode - 박주영의 위키</title>

    <meta name="description" content="">
    <meta name="google-site-verification" content="xD2UvBTOH6xxBi9MseahHz4Nt9u2vYZbgY2wVo7Bdyc">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://jxmen.github.io/wiki/java/equals-and-hashCode/">
    <link rel="alternate" type="application/rss+xml" title="박주영의 위키" href="https://jxmen.github.io/feed.xml">

    <meta property="og:type" content="website">
    <meta property="og:title" content="equals와 hashCode">
    <meta property="og:description" content="">
    <!---
    <meta property="og:image" content="https://jxmen.github.io/resource/johngrib.png">
    -->
    <meta property="og:url" content="https://jxmen.github.io/wiki/java/equals-and-hashCode/">

    <meta name="google-site-verification" content="IoNEKzwdxuYHx0g2nEWusOJ2kK0ompxgUZ-evn27Vlk">

    <!--- 
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@" />
        <meta name="twitter:url" content="https://jxmen.github.io/wiki/java/equals-and-hashCode/" />
        <meta name="twitter:title" content="equals와 hashCode" />
        <meta name="twitter:description" content="" />
    --->

    <!---
    <link rel="apple-touch-icon" sizes="57x57"        href="/resource/icon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60"        href="/resource/icon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72"        href="/resource/icon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76"        href="/resource/icon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114"      href="/resource/icon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120"      href="/resource/icon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144"      href="/resource/icon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152"      href="/resource/icon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180"      href="/resource/icon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/resource/icon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32"   href="/resource/icon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96"   href="/resource/icon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16"   href="/resource/icon/favicon-16x16.png">
    <link rel="manifest" href="/resource/icon/manifest.json">
    --->
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/resource/icon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">




</head>
<body>
<header class="header">
    <div>
        <a class="site-title" href="/">박주영의 위키</a>
    </div>
    <div>
        <a class="site-title-right" href="/about/">me</a>
    </div>
    <div>
        <a id="random-button" class="site-title-right">random</a>
    </div>
    <div>
        <!---<a class="site-title-right" href="/wiki/root-index/">index</a> --->
        <a class="site-title-right" href="/wiki/index/">index</a>
    </div>
</header>
<script async src="/js/shortcut.js"></script>

    
        <div class="page-content">
            <div class="search">
    <form role="search" method="get" action="/search/">
         <input name="searchString" class="searchInput" placeholder=" 검색하세요" type="text">
         <input type="submit" class="searchButton" value="Search">
    </form>
</div>
            <div class="post">
                
<input type="hidden" id="thisName" value="java/equals-and-hashCode">
<div class="post">
    <header class="post-header">
        <h1 class="page-title">
            <a href="/wiki/java/equals-and-hashCode/"> equals와 hashCode </a>
        </h1>
    
        <div class="history-button">
            <p><a href="https://github.com/jxmen/jxmen.github.io/blame/main/_wiki/java/equals-and-hashCode.md" target="_blank">created: 2024.02.02</a></p>
            <p><a href="https://github.com/jxmen/jxmen.github.io/blame/main/_wiki/java/equals-and-hashCode.md" target="_blank">updated: 2024.02.02</a></p>
            <p>
                <a href="https://github.com/jxmen/jxmen.github.io/edit/main/_wiki/java/equals-and-hashCode.md">편집하기</a>
                /
                <a href="https://github.com/jxmen/jxmen.github.io/issues/new?title=equals%EC%99%80+hashCode&amp;body=%EC%9D%98%EA%B2%AC%EC%9D%84%20%EB%82%A8%EA%B2%A8%EC%A3%BC%EC%84%B8%EC%9A%94">의견 남기기</a>
            </p>
        </div>

        <div id="parent-list"></div>



    <div class="post-tag">
    java
</div>




    </header>
    <article class="post-content">
        <ul id="markdown-toc">
  <li><a href="#equals%EB%A5%BC-%EC%9E%AC%EC%A0%95%EC%9D%98-%ED%95%B4%EC%95%BC-%ED%95%A0-%EB%95%8C%EB%8A%94-%EC%96%B8%EC%A0%9C%EC%9D%BC%EA%B9%8C" id="markdown-toc-equals를-재정의-해야-할-때는-언제일까">equals를 재정의 해야 할 때는 언제일까?</a></li>
  <li><a href="#equals-%EB%A9%94%EC%84%9C%EB%93%9C%EB%A5%BC-%EC%9E%AC%EC%A0%95%EC%9D%98%EB%A5%BC-%EC%9C%84%ED%95%9C-%EC%9D%BC%EB%B0%98-%EA%B7%9C%EC%95%BD-%EC%9A%94%EC%95%BD" id="markdown-toc-equals-메서드를-재정의를-위한-일반-규약-요약">equals 메서드를 재정의를 위한 일반 규약 요약</a></li>
  <li><a href="#%EC%84%A4%EA%B3%84-%EC%98%A4%EB%A5%98%EB%A1%9C-%EC%9D%B8%ED%95%B4-equals%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%A9%B4-%EC%95%88%EB%90%98%EB%8A%94-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC" id="markdown-toc-설계-오류로-인해-equals를-사용하면-안되는-라이브러리">설계 오류로 인해 equals를 사용하면 안되는 라이브러리</a></li>
  <li><a href="#hashcode%EB%A5%BC-%EC%9E%98%EB%AA%BB-%EC%A7%80%EC%A0%95%ED%95%98%EB%A9%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%90%A0%EA%B9%8C" id="markdown-toc-hashcode를-잘못-지정하면-어떻게-될까">hashCode를 잘못 지정하면 어떻게 될까?</a></li>
  <li><a href="#%EC%A2%8B%EC%9D%80-%ED%95%B4%EC%8B%9C-%ED%95%A8%EC%88%98%EB%9E%80" id="markdown-toc-좋은-해시-함수란">좋은 해시 함수란?</a></li>
  <li><a href="#%EC%A3%BC%EC%84%9D" id="markdown-toc-주석">주석</a></li>
</ul>

<h3 id="equals를-재정의-해야-할-때는-언제일까">equals를 재정의 해야 할 때는 언제일까?</h3>

<blockquote>
  <p>객체 식별성이 아니라 <strong>논리적 동치성</strong>을 확인해야 하는데, 상위 클래스의 equals가 논리적 동치성을 비교하도록 재정의하지 않았을 때다. 주로 값 클래스들이 해당한다. <sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup></p>
</blockquote>

<p>결론적으로는 "값"이 같을때 같은 취급을 하고 싶은 경우 equals를 재정의하는 것이다.</p>

<h3 id="equals-메서드를-재정의를-위한-일반-규약-요약">equals 메서드를 재정의를 위한 일반 규약 요약</h3>

<p>일반 규약을 지키도록 해야한다. 컬렉션 클래스를 포함해 수많은 클래스는 전달받은 객체가 equals 규약을 지킨다고 가정한다.</p>

<ul>
  <li>반사성 <code class="language-plaintext highlighter-rouge">x.equals(x) == true</code>
</li>
  <li>대칭성 <code class="language-plaintext highlighter-rouge">x.equals(y) == y.equals(x)</code>
</li>
  <li>추이성 <code class="language-plaintext highlighter-rouge">x.equals(y) == y.equals(z) == x.equals(z)</code>
</li>
  <li>일관성 <code class="language-plaintext highlighter-rouge">x.equals(y) // n번 호출해도 모두 true</code>
</li>
  <li>null-아님 <code class="language-plaintext highlighter-rouge">x.equals(null) // false</code>
</li>
</ul>

<h3 id="설계-오류로-인해-equals를-사용하면-안되는-라이브러리">설계 오류로 인해 equals를 사용하면 안되는 라이브러리</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">java.sql.Timestamp</code>: java.util.Date를 확장한 후 nanoseconds 필드를 추가</li>
  <li>
<code class="language-plaintext highlighter-rouge">java.net.URL</code>: 주어진 URL과 매핑된 호스트의 IP 주소를 통해 비교</li>
</ul>

<h3 id="hashcode를-잘못-지정하면-어떻게-될까">hashCode를 잘못 지정하면 어떻게 될까?</h3>

<p>HashMap, HashSet 등의 컬렉션 프레임워크 클래스를 사용할 때, 내가 원하는 값을 찾지 못할 수 있다.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Nested</span>
<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"논리적으로 같은 객체가 다른 해시코드를 반환할 때"</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">NonHashCodePhoneNumberTest</span> <span class="o">{</span>

	<span class="nd">@Test</span>
	<span class="nd">@DisplayName</span><span class="o">(</span><span class="s">"해시 기반 컬렉션에서 null을 리턴한다."</span><span class="o">)</span>
	<span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
		<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">PhoneNumber</span><span class="o">,</span> <span class="nc">String</span><span class="o">&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>
		<span class="n">m</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="k">new</span> <span class="nc">PhoneNumber</span><span class="o">(</span><span class="mi">707</span><span class="o">,</span> <span class="mi">867</span><span class="o">,</span> <span class="mi">5309</span><span class="o">),</span> <span class="s">"제니"</span><span class="o">);</span>

		<span class="k">assert</span> <span class="n">m</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="k">new</span> <span class="nc">PhoneNumber</span><span class="o">(</span><span class="mi">707</span><span class="o">,</span> <span class="mi">867</span><span class="o">,</span> <span class="mi">5309</span><span class="o">))</span> <span class="o">==</span> <span class="kc">null</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Map의 경우 key값으로 객체의 해시 값을 저장하는데, 해시코드가 정의되지 않을 경우 다른 해시코드를 찾게 되어 null이 반환될 수 있다.</p>

<h3 id="좋은-해시-함수란">좋은 해시 함수란?</h3>

<p>이상적인 해시 함수는 주어진 인스턴스들을 <code class="language-plaintext highlighter-rouge">32비트</code> 정수 범위에 균일하게 분배하는 것이라고 한다.</p>

<h2 id="주석">주석</h2>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>이펙티브 자바 3판. 아이템 10. 53쪽. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
  </ol>
</div>

    </article>


    
<div class="giscus"></div>
<div class="post-comments">
  <script src="https://giscus.app/client.js" data-repo="jxmen/jxmen.github.io" data-repo-id="R_kgDOLKyoHA" data-category="Comments" data-category-id="DIC_kwDOLKyoHM4CdGSe" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="noborder_light" data-lang="ko" crossorigin="anonymous" async></script>
</div>




</div>
<script async src="/js/create-link.js"></script>


<script async>
    ;(function() {
        const tableList = document.querySelectorAll('.table-generate');

        if (tableList == null) {
            return;
        }

        for (let i = 0; i < tableList.length; i++) {
            const ul = tableList[i];
            const draw = {
                th: '',
                td: ''
            };

            const rows = ul.children;
            for (let j = 0; j < rows.length; j++) {
                const row = rows[j].children[0];
                const columns = row.children;
                const isHeader = /^th/.test(rows[j].innerHTML);
                const colTag = isHeader ? 'th' : 'td';

                let colData = '';
                for (let k = 0; k < columns.length; k++) {
                    const column = columns[k];
                    const content = column.innerHTML;
                    colData += `<${colTag}>${content}</${colTag}>`;
                }

                const trHtml = `<tr>${colData}</tr>`

                draw[colTag] += trHtml;
            }

            const result = `
                <table>
                    <thead>${draw.th}</thead>
                    <tbody>${draw.td}</tbody>
                </table>`

            const targetId = ul.getAttribute('data-target-id');
            document.getElementById(targetId).innerHTML = result;
            ul.remove();
        }
    })();
    ;(function() {
        const source = document.querySelectorAll('.dynamic-insert');

        if (source == null) {
            return;
        }

        for (let i = 0; i < source.length; i++) {
            const item = source[i];

            const target = item.getAttribute('data-target-selector');
            document.querySelector(target).innerHTML = item.outerHTML;
            item.remove();
        }
    })();
</script>


<script async src="/js/parent.js"></script>
<script async src="/js/toc-highlight.js"></script>

            </div>
        </div>
        <footer class="footer">
    <div>

    </div>

</footer>
    
</body>
</html>
